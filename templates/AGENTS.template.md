# AGENTS.md (레포 맞춤형, 자동 생성)

## 0. 이 문서의 목적
이 문서는 VSCode Codex(또는 CLI)가 이 레포에서 작업할 때 반드시 지켜야 하는 규칙을 정의합니다.
목표는 “품질, 보안, 운영 안정성”을 해치지 않으면서 작업 속도를 올리는 것입니다.

## 1. 절대 규칙(위반 금지)
1) 추측 금지
- 파일, 명령, 경로, 스크립트는 반드시 실제 레포에서 확인한 것만 사용합니다.

2) 파괴적 Git 명령 금지
- 다음 명령은 사용하지 않습니다.
  - git reset --hard
  - git clean -fd
  - git push --force
  - git rebase --onto (사전 합의 없는 경우)

3) 시크릿 및 민감정보 취급
- 키, 토큰, 비밀번호, 쿠키 등은 코드에 하드코딩하지 않습니다.
- 로그에 개인정보 또는 인증정보가 노출되지 않도록 마스킹합니다.

4) 멀티테넌트 기본선
- 모든 데이터 접근은 companyId 필터가 반드시 적용되어야 합니다.
- 타사 데이터 접근 가능성이 생기면 즉시 중단하고 설계를 수정합니다.

5) 단순성 우선
- 과도한 추상화, 불필요한 패턴 도입을 금지합니다.
- 지금 필요한 기능만 구현하고, 확장 포인트는 구조로만 준비합니다.

## 2. 작업 방식(Plan → Execute → Verify → Review)
- Plan: `.codex/PLANS.md` 템플릿으로 계획만 작성(코드 변경 금지)
- Execute: 한 번에 파일 1~2개만 수정, “Step 1만” 수행
- Verify: 레포에 존재하는 명령으로 lint/test/smoke/perf-gate를 실행
- Review: 멀티테넌트, 보안, 성능, 로그, 에러코드 일관성 관점으로 자체 리뷰

## 3. 레포에서 감지된 명령(자동 채움)
아래 값은 스캔 결과로 채워집니다. 값이 비어 있으면 codex-scan-report.md를 확인하세요.

- npm scripts:
{{SCRIPTS_SUMMARY}}

- smoke.ps1:
{{SMOKE_PATH}}

- perf-gate.ps1:
{{PERF_GATE_PATH}}

## 4. 코딩 품질 체크 포인트(핵심만)
- 입력 검증: null, 빈값, 최대 길이, 특수문자, 시간대
- 에러 처리: 표준 에러코드, 사용자 메시지와 내부 메시지 분리
- 성능: 페이징 기본, N+1 방지, 대용량 전체 로딩 금지
- 로그: Correlation ID 포함, 민감정보 마스킹
